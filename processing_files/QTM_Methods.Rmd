---
title: "QTM302W Methods Section"
author: "Isabella Adeola, Christina Dai, Hank Standaert"
date: "2025-11-06"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

```{r}
library(readr)
library(here)
library(dplyr)
library(tidyverse)
library(ggplot2)
library(kableExtra)
library(gridExtra)
```

```{r}
ciri_data <- read_csv(here("data", "CIRI_data", "CIRI_data_raw.csv")) 

#Removing unnecessary variables from data set
df <- ciri_data %>% 
  select(-c(DISAP,
            UNCTRY,
            CIRI,
            KILL, 
            POLPRIS,
            COW, 
            TORT,
            UNSUBREG, 
            POLITY,
            OLD_EMPINX,
            NEW_EMPINX,
            ASSN,
            FORMOV,
            DOMMOV,
            OLD_MOVE,
            SPEECH,
            ELECSD,
            OLD_RELFRE,
            NEW_RELFRE,
            WORKER,
            WOSOC,
            INJUD)) 
```

```{r}
# Checking for number of NA's in each variable and deleting rows with NA's
print(colSums(is.na(df))) 
df_full <- na.omit(df) 

# Checking for duplicates within variables and duplicate rows
print(sum(duplicated(df_full))) 
df_no_dups <- distinct(df_full) 

```

```{r}
# Making missing code, periods of interregnum, and occupation NAs
df_no_dups[df_no_dups == -999] <- NA
df_no_dups[df_no_dups == -77]  <- NA
df_no_dups[df_no_dups == -66]  <- NA

# Creating decade variable 
df_decade_region <- df_no_dups %>% 
  mutate(DECADE = floor(YEAR/10)*10)

# Map UNREG codes to continent/region names
region_map <- tibble(
  UNREG = c(2, 9, 419, 21, 142, 150),
  CONT = c("Africa", "Oceania", "South & Central America", "North America" , "Asia", "Europe") 
) 

# Combining the two tables
df_decade_region <- df_decade_region %>%
  left_join(region_map, by = "UNREG")

# Getting rid of duplicate column and renaming `CONT.x`
df_decade_region$CONT.y <- NULL

names(df_decade_region)[names(df_decade_region) == "CONT.x"] <- "CONT"

df_decade_region
```

```{r}
# Creating data frame for just Africa
df_africa <- df_decade_region %>% 
  filter(CONT == 'Africa')

head(df_africa)
```

```{r}
# Creating data frame for just continental countries
island_list <- c("Madagascar", "Comoros",
         "Mauritius", "Seychelles", "Cape Verde", "Sao Tome and Principe")

df_africa_cont <- df_africa %>% 
  filter(CTRY != island_list)

head(df_africa_cont)
```

```{r}
# Creating data frame for just African island nations
df_islands <- df_africa %>%
  filter(CTRY == island_list)

head(df_islands)
```

```{r}
# Reading new data set 
africa_popgdp <- read_csv(here("data", "africapolis_data", "africa_popgdp.csv")) 

head(africa_popgdp)
```

```{r}
names(africa_popgdp)[names(africa_popgdp) == "YEAR"] <- "DECADE"
```

```{r}
africa_cont_joined <- df_africa_cont %>% 
  left_join(africa_popgdp, by = c("CTRY", "DECADE")) 

africa_cont_joined
```

```{r}
islands_joined <- df_islands %>% 
  left_join(africa_popgdp, by = c("CTRY", "DECADE"))

islands_joined
```

After reviewing the data set for our island_joined information, we chose to only keep the data after 2000 since any data that was before that year was missing/ full of NAs.

### Comparing the Differences in PHYSINT Between Island Nations and Mainland by Years

PHYSINT: Physical Integrity Rights Index\
This is an index constructed from the Torture, Extrajudicial Killing, Political Imprisonment, and Disappearance indicators. It ranges from 0 (no government respect for these four rights) to 8 (full government respect for these four rights).

```{r}
#creating a new category for each data set then combining them
islands_joined <- islands_joined %>% 
  mutate(region = "Island Nations")

africa_cont_joined <- africa_cont_joined %>% 
  mutate(region = "Mainland Africa")

combined_df <- bind_rows(islands_joined, africa_cont_joined)
```

```{r}
ggplot(combined_df, aes(x = YEAR, y = PHYSINT, color = region)) +
  geom_line(stat = "summary", fun = mean, size = 1.2) +  
  geom_point(stat = "summary", fun = mean, size = 2) +    
  labs(
    title = "Comparison of PHYSINT Scores: Island Nations vs Mainland Africa",
    x = "Year",
    y = "Average PHYSINT Score",
    color = "Region"
  ) +
  theme_minimal() +
  scale_color_manual(values = c("Island Nations" = "steelblue", "Mainland Africa" = "darkorange"))
```

[enter interpretation here, making sure to mention the huge fluctuations for island nations]

### Comparing the Differences in Women's Political and Economic Rights Between Island Nations and Mainland by Decades

### WECON Comparison

```{r}
#Capturing the Average Scores from Data Set
mean_rights <- combined_df %>%
  group_by(DECADE, region) %>%
  summarize(
    mean_WECON = mean(WECON, na.rm = TRUE),
    mean_WOPOL = mean(WOPOL, na.rm = TRUE)
  ) %>%
  pivot_longer(
    cols = c(mean_WECON, mean_WOPOL),
    names_to = "Right_Type",
    values_to = "Mean_Score"
  )
```

```{r}
#Comparisons
ggplot(mean_rights, aes(x = factor(DECADE), y = Mean_Score, fill = region)) +
  geom_bar(stat = "identity", position = "dodge") +
  facet_wrap(~ Right_Type, scales = "free_y") +
  labs(
    title = "Comparison of Women's Economic and Political Rights Over Time",
    x = "Year",
    y = "Mean Score",
    fill = "Region"
  ) +
  theme_minimal() +
  scale_fill_manual(values = c("Island Nations" = "steelblue", "Mainland Africa" = "darkorange"))
```

[enter interpretation here]

### Exploring Influential Factors Contributing to Women's Economic Rights Between the Island Nations

We hypothesized that GDP, as a measure of a nation’s economic status, would be associated with women’s economic rights (WECON).

To explore this, we averaged the WECON scores over time for each island nation and plotted them against the corresponding average GDP values across the decades, arranged in ascending order of GDP. This visualization allowed us to examine whether higher economic status corresponded to greater women’s economic rights.

```{r}
summary_df <- islands_joined %>%
  group_by(CTRY) %>%
  summarize(
    mean_WECON = mean(WECON, na.rm = TRUE),
    mean_GDP = mean(GDP, na.rm = TRUE)
  )

ggplot(summary_df, aes(x = reorder(CTRY, mean_GDP), y = mean_WECON, fill = mean_GDP)) +
  geom_bar(stat = "identity") +
  scale_fill_gradient(low = "lightpink", high = "darkmagenta") +
  coord_flip() +
  theme_minimal()
```

From the visualization, there is no clear indication of any sort of trend/ correlation between the two variables of interests so we pivoted to a linear regression model.

```{r}
# Linear Regression Model
model1 <- lm(WECON ~ GDP + TPOP + URBPOP + AREA + TPOP*GDP, data = islands_joined)
summary(model1)
```

The multiple linear regression model examined the effects of GDP, total population (TPOP), urban population (URBPOP), land area (AREA), and the interaction between GDP and TPOP on WECON scores. The overall model was not statistically significant (F(5,12) = 2.08, p = 0.1386), and explained approximately only 24% of the variance in WECON scores after adjusting for the number of predictors (Adjusted R² = 0.2411).

Individually, most predictors, including GDP, TPOP, URBPOP, and AREA, were not statistically significant (p \> 0.05). However, the interaction term GDP:TPOP was significant (p = 0.0472), suggesting that the combined effect of GDP and population may influence WECON scores even though the main effects alone are not significant.

Overall, while GDP alone does not appear to significantly predict WECON scores, its interaction with population may play a meaningful role, highlighting the importance of considering combined socio-economic factors.

### Exploring Influential Factors Contributing to Women's Political Rights Between the Island Nations

We hypothesized that an island nation’s population size might influence women’s political rights (WOPOL). For example, in smaller populations, each individual’s opinion may carry more weight, potentially giving women greater influence in government.

To explore this, we averaged WOPOL scores over time for each island nation and plotted them against the corresponding average total population (TPOP) across the decades, arranged in ascending order of TPOP. This visualization allowed us to examine whether smaller populations were associated with higher women’s political rights.

```{r}
summary_df2 <- islands_joined %>%
  group_by(CTRY) %>%
  summarize(
    mean_WOPOL = mean(WOPOL, na.rm = TRUE),
    mean_TPOP = mean(TPOP, na.rm = TRUE)
  )

ggplot(summary_df2, aes(x = reorder(CTRY, mean_TPOP), y = mean_WOPOL, fill = mean_TPOP)) +
  geom_bar(stat = "identity") +
  scale_fill_gradient(low = "lightblue", high = "navy") +
  coord_flip() +
  theme_minimal()
```

We cannot say for sure that there is a definitive correlation from this visual, but there does seem to be a trend where the smaller populations have generally higher women political rights.

To check if there is a correlation, we conducted a multiple linear regression to examine the effects of GDP, total population (TPOP), urban population (URBPOP), land area (AREA), and the interaction between TPOP and AREA on women’s political rights (WOPOL) in island nations.

```{r}
# Linear Regression Model 2
model2 <- lm(WOPOL ~ GDP + TPOP + URBPOP + AREA + TPOP*AREA, data = islands_joined)
summary(model2)
```

The overall model was not statistically significant (F(5,12) = 1.873, p = 0.173), explaining approximately only 20% of the variance in WOPOL scores after adjusting for the number of predictors (Adjusted R² = 0.2043).

Individually, none of the predictors—including GDP, TPOP, URBPOP, AREA, and the TPOP:AREA interaction—were statistically significant at the 0.05 level. The interaction term (TPOP:AREA) had the lowest p-value (p = 0.180), suggesting a possible, though non-significant, combined effect of population and land area on women’s political rights.

Overall, these results indicate that, based on this dataset, there is no strong evidence that GDP, population size, urbanization, land area, or their interaction significantly predict women’s political rights in island nations.

### Exploring Influential Factors Contributing PHYSINT Between the Island Nations

Next, we wanted to explore if there were any correlations for variables within island nations to PHYSINT. We ran a multiple variable linear regression and after testing out multiple different variable interaction combinations, we were able to identify our most significant result with the following model:

```{r}
# Linear Regression Model 3
model3 <- lm(PHYSINT ~ GDP + TPOP + URBPOP + AREA + AREA*URBPOP, data = islands_joined)
summary(model3) 
```

The model significantly predicts PHYSINT and explains about 67% of its variation, but none of the individual predictors or the AREA × URBPOP interaction are statistically significant as shown by their low p-values.\
GDP and URBPOP come close to significance, suggesting they may have some influence, but the evidence is too weak to draw firm conclusions. The non-significant interaction means that urban population does not affect PHYSINT differently depending on a country's land area. Overall, the model fits reasonably well, but it cannot identify any strong, reliable predictors of PHYSINT from these variables.

```{r}

# GDP
p1 <- ggplot(islands_joined, aes(x = GDP, y = PHYSINT)) +
  geom_point(size = 3, color = "steelblue") +
  geom_smooth(method = "lm", se = TRUE, color = "red", linewidth = 1) +
  labs(title = "PHYSINT vs GDP",
       x = "GDP",
       y = "PHYSINT") +
  theme_minimal()

# Urban Population
p2 <- ggplot(islands_joined, aes(x = URBPOP, y = PHYSINT)) +
  geom_point(size = 3, color = "darkmagenta") +
  geom_smooth(method = "lm", se = TRUE, color = "red", linewidth = 1) +
  labs(title = "PHYSINT vs Urban Population",
       x = "Urban Population",
       y = "PHYSINT") +
  theme_minimal()

grid.arrange(p1, p2, ncol = 2) 
```

Plots of the two variable interactions that show slight significance.
